<div class="snow">
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
  <div class="snow__flake">ğŸ¸</div>
</div>
<style>
  *,
  *::before,
  *::after {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }

  .snow-toggle {
    display: flex;
    flex-direction: row;
    padding: 0;
    margin: 0;
    gap: 40px;
    border: 0;
  }

  .snow-toggle__label {
    padding-bottom: 10px;
  }

  .snow-toggle__item {
    position: relative;
    display: flex;
    align-items: center;
    cursor: pointer;
  }

  .snow-toggle__text::before {
    content: "";
    position: absolute;
    left: 0;
    top: calc(50% - 12px);
    width: 25px;
    height: 25px;
    border: 1px solid #ffffff;
    border-radius: 50%;
  }

  .snow-toggle__control {
    width: 25px;
    height: 25px;
    opacity: 0;
    margin-right: 15px;
  }

  .snow-toggle__control:focus + .snow-toggle__text::before {
    border-color: #2e9aff;
  }

  .snow-toggle__control:checked + .snow-toggle__text::before {
    background-color: #ffffff;
    background: radial-gradient(
      circle,
      #ffffff 0%,
      #ffffff 40%,
      transparent 50%,
      transparent 100%
    );
  }

  .snow {
    --animation-name: snowfall;
    position: fixed;
    left: 0;
    right: 0;
    top: 0;
    bottom: 0;
    z-index: 100;
    display: flex;
    justify-content: space-between;
    pointer-events: none;
  }

  .snow__flake {
    position: relative;
    top: -1.5em;
    animation-name: var(--animation-name);
    animation-timing-function: ease-in-out;
    animation-iteration-count: infinite;
    will-change: transform;
    font-size: 2rem;
  }

  @keyframes snowfall {
    0% {
      transform: translateY(0);
    }

    100% {
      transform: translateY(calc(100vh + 1.5em));
    }
  }
</style>
<script>
  const storageKey = "snow";
  const snow = document.querySelector(".snow") as HTMLElement;
  const snowflakes = document.querySelectorAll(".snow__flake");
  const snowToggle = document.querySelector(".snow-toggle") as HTMLElement;
  const aboutHighlight = document.querySelector(
    ".about-highlight"
  ) as HTMLElement;

  // ĞŸÑ€Ğ¾Ğ²ĞµÑ€ĞºĞ° Ğ½Ğ°Ğ»Ğ¸Ñ‡Ğ¸Ñ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ¾Ğ²
  if (!snow || !snowToggle || !aboutHighlight) {
    console.error("Required elements are missing in the DOM.");
  }

  function getRndInteger(min: number, max: number): number {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function getRndFloat(min: number, max: number): string {
    return (Math.random() * (max - min) + min).toFixed(1);
  }

  // ĞĞ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºĞ° ÑĞ½ĞµĞ¶Ğ¸Ğ½Ğ¾Ğº
  snowflakes.forEach((snowflake) => {
    if (snowflake instanceof HTMLElement) {
      snowflake.style.fontSize = getRndFloat(0.7, 1.5) + "em";
      snowflake.style.animationDuration = getRndInteger(20, 30) + "s";
      snowflake.style.animationDelay =
        getRndInteger(-1, snowflakes.length / 2) + "s";
    }
  });

  function changeSnowAnimation(animationName: string) {
    if (snow) {
      snow.style.setProperty("--animation-name", animationName);
    }
  }

  function toggleSnowAnimation() {
    const isSnowEnabled =
      snow.style.getPropertyValue("--animation-name") !== "none";

    if (isSnowEnabled) {
      // Ğ•ÑĞ»Ğ¸ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ²ĞºĞ»ÑÑ‡ĞµĞ½Ğ°, Ğ²Ñ‹ĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ ĞµÑ‘
      snow.style.setProperty("--animation-name", "none");
      localStorage.removeItem(storageKey);
    } else {
      // Ğ•ÑĞ»Ğ¸ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ²Ñ‹ĞºĞ»ÑÑ‡ĞµĞ½Ğ°, Ğ²ĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ ĞµÑ‘
      const newAnimation = localStorage.getItem(storageKey) || "snowfall"; // Ğ—Ğ°Ğ¼ĞµĞ½Ğ¸Ñ‚Ğµ "snowfall" Ğ½Ğ° Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ, ĞµÑĞ»Ğ¸ Ğ½ÑƒĞ¶Ğ½Ğ¾
      changeSnowAnimation(newAnimation);
      localStorage.setItem(storageKey, newAnimation);
    }
  }

  // ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‡Ğ¸Ğº ĞºĞ»Ğ¸ĞºĞ° Ğ½Ğ° span Ğ´Ğ»Ñ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ñ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸ ÑĞ½ĞµĞ³Ğ°
  aboutHighlight.addEventListener("click", () => {
    // ĞŸĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ ÑĞ½ĞµĞ³Ğ° Ğ¿Ñ€Ğ¸ ĞºĞ»Ğ¸ĞºĞµ Ğ½Ğ° span
    toggleSnowAnimation();
  });

  // ĞŸÑ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹
  document.addEventListener("DOMContentLoaded", () => {
    // Ğ¡Ğ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸ Ğ½Ğµ Ğ¸Ğ·Ğ¼ĞµĞ½ÑĞµÑ‚ÑÑ Ğ¿Ñ€Ğ¸ Ğ·Ğ°Ğ³Ñ€ÑƒĞ·ĞºĞµ ÑÑ‚Ñ€Ğ°Ğ½Ğ¸Ñ†Ñ‹, Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ¸Ğ·Ğ±ĞµĞ¶Ğ°Ñ‚ÑŒ Ğ¿Ñ€ĞµĞ¶Ğ´ĞµĞ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ğ¾Ğ³Ğ¾ ÑÑ‚Ğ°Ñ€Ñ‚Ğ° Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸

    // Ğ•ÑĞ»Ğ¸ ĞµÑÑ‚ÑŒ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ½Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ² localStorage, ÑƒÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°Ñ‚ĞµĞ»ĞµĞ¹
    const currentStorage = localStorage.getItem(storageKey);
    if (currentStorage) {
      // Ğ’ĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ, ĞµÑĞ»Ğ¸ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½Ğ½Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ ÑÑƒÑ‰ĞµÑÑ‚Ğ²ÑƒĞµÑ‚
      changeSnowAnimation(currentStorage);

      // Ğ£ÑÑ‚Ğ°Ğ½Ğ°Ğ²Ğ»Ğ¸Ğ²Ğ°ĞµĞ¼ ÑĞ¾ÑÑ‚Ğ¾ÑĞ½Ğ¸Ğµ Ğ¿ĞµÑ€ĞµĞºĞ»ÑÑ‡Ğ°Ñ‚ĞµĞ»ĞµĞ¹ Ğ² Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚Ğ¸ Ğ¾Ñ‚ Ñ‚ĞµĞºÑƒÑ‰ĞµĞ¹ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ğ¸
      const controls = snowToggle.querySelectorAll(".snow-toggle__control");
      controls.forEach((control) => {
        if (control instanceof HTMLInputElement) {
          control.checked = control.value === currentStorage;
        }
      });
    } else {
      // Ğ˜Ğ·Ğ½Ğ°Ñ‡Ğ°Ğ»ÑŒĞ½Ğ¾ Ğ¾Ñ‚ĞºĞ»ÑÑ‡Ğ°ĞµĞ¼ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ
      snow.style.setProperty("--animation-name", "none");
    }

    // ĞĞ±Ğ½Ğ¾Ğ²Ğ»ÑĞµĞ¼ Ğ°Ğ½Ğ¸Ğ¼Ğ°Ñ†Ğ¸Ñ Ğ¿Ñ€Ğ¸ Ğ¸Ğ·Ğ¼ĞµĞ½ĞµĞ½Ğ¸Ğ¸ localStorage
    window.addEventListener("storage", () => {
      const updatedAnimation = localStorage.getItem(storageKey) || "none";
      changeSnowAnimation(updatedAnimation);
    });
  });
</script>
