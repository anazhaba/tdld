<h1 class="faq-title">Ответы на вопросы</h1>
<div class="faq-container">
  <div class="faq-item">
    <div class="faq-question">
      Имеет ли срок действия приобретенная проходка?
      <img src="/icons/arrow_down.svg" alt="Toggle" class="faq-icon" />
    </div>
    <div class="faq-answer">
      <p>
        На данный момент приобретенная проходка не имеет срока действия и
        остаётся активной на неограниченный срок. Мы оставляем за собой право в
        будущем установить временные ограничения, если это будет необходимо.
      </p>
    </div>
  </div>
  <div class="faq-item">
    <div class="faq-question">
      Могу ли я вернуть деньги если мне не понравится сервер?<img
        src="/icons/arrow_down.svg"
        alt="Toggle"
        class="faq-icon"
      />
    </div>
    <div class="faq-answer">
      <p>
        Да, вы имеете возможность вернуть деньги, если сервер не оправдал ваших
        ожиданий. Однако возврат средств возможен только в течение первого дня с
        момента первого захода на сервер. Важно отметить, что все комиссии за
        возврат средств будут переложены на вас.
      </p>
    </div>
  </div>
  <div class="faq-item">
    <div class="faq-question">
      Я хочу связаться с администрацией перед покупкой<img
        src="/icons/arrow_down.svg"
        alt="Toggle"
        class="faq-icon"
      />
    </div>
    <div class="faq-answer">
      <p>
        Если у вас есть вопросы или вам требуется дополнительная информация
        перед покупкой, вы можете связаться с администрацией нашего сервера. Для
        этого перейдите по следующей <a
          href="https://t.me/toadland_bot"
          class="faq-link">ссылке</a
        >. Наша команда будет рада помочь вам и ответить на все ваши вопросы.
      </p>
    </div>
  </div>
  <div class="faq-item">
    <div class="faq-question">
      Какие модификации установленны на сервере?<img
        src="/icons/arrow_down.svg"
        alt="Toggle"
        class="faq-icon"
      />
    </div>
    <div class="faq-answer">
      <p>
        Мы используем несколько модификаций для улучшения игрового процесса на
        нашем сервере. Полный список установленных модификаций доступен на
        <a href="/mods" class="faq-link">отдельной странице</a>.
      </p>
    </div>
  </div>
  <div class="faq-item">
    <div class="faq-question">
      У меня нет возможности оплатить доступ по предложенным реквизитам<img
        src="/icons/arrow_down.svg"
        alt="Toggle"
        class="faq-icon"
      />
    </div>
    <div class="faq-answer">
      <p>
        Если вы сталкиваетесь с трудностями при оплате доступа по предложенным
        реквизитам, пожалуйста, свяжитесь с нами. Мы постараемся предложить
        альтернативные варианты или помочь вам в решении проблемы. Напишите нам
        по <a href="https://t.me/toadland_bot" class="faq-link">ссылке</a>, и мы
        обязательно найдем решение.
      </p>
    </div>
  </div>
  <div class="faq-item">
    <div class="faq-question">
      Есть ли возможность зайти бесплатно, посмотреть сервер чтобы решить хочу
      ли я у вас играть?<img
        src="/icons/arrow_down.svg"
        alt="Toggle"
        class="faq-icon"
      />
    </div>
    <div class="faq-answer">
      <p>
        Мы понимаем, что вам может быть интересно сначала ознакомиться с
        сервером, прежде чем принимать решение о покупке. Мы готовы рассмотреть
        возможность предоставления бесплатного доступа на ограниченное время в
        индивидуальном порядке. Чтобы обсудить детали и условия, пожалуйста,
        <a href="https://t.me/toadland_bot" class="faq-link">свяжитесь с нами</a
        >.
      </p>
    </div>
  </div>
  <div class="faq-item">
    <div class="faq-question">
      За что я плачу когда делаю пожертвование?<img
        src="/icons/arrow_down.svg"
        alt="Toggle"
        class="faq-icon"
      />
    </div>
    <div class="faq-answer">
      <p>
        Ваши пожертвования направляются на частичную компенсацию расходов,
        связанных с хостингом нашего сервера. Мы являемся некоммерческим
        проектом и не предоставляем донатных привилегий. Все средства идут на
        поддержание и развитие сервера, а наша команда покрывает оставшиеся
        затраты из собственных средств. Более подробную информацию о нашем
        проекте можно найти на отдельной <a href="/about" class="faq-link"
          >странице</a
        >.
      </p>
    </div>
  </div>
</div>
<style>
  .faq-container {
    margin-top: 20px;
  }
  .faq-item {
    margin-bottom: 10px;
  }
  .faq-question::selection {
    background-color: initial;
    color: inherit;
  }
  .faq-question {
    background-color: var(--color-green-300);
    transition: 0.2s;
    color: #fff;
    border: none;
    padding: 15px;
    border-radius: 10px 10px 0 0;
    text-align: left;
    cursor: pointer;
    font-size: 1.5rem;
    font-family: gilroy-bold;
    position: relative;
    display: flex;
    align-items: center;
  }
  .faq-question:hover {
    background-color: var(--color-green-400);
  }
  .faq-link {
    text-decoration: none;
    font-family: gilroy-bold;
    color: var(--color-green-400);
    transition: 0.2s;
  }
  .faq-link:hover {
    color: var(--color-green-500);
  }
  .faq-icon::selection {
    background-color: initial;
    color: initial;
  }
  .faq-icon {
    margin-left: auto;
    width: 24px;
    height: 24px;
    transition: transform 0.2s ease;
  }

  .faq-answer {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.2s ease-out;
    background-color: var(--color-white);
    font-family: gilroy-medium;
    font-size: 1.2rem;
    border-radius: 0 0 10px 10px;
  }

  .faq-answer p {
    margin: 10px;
  }

  .faq-item.active .faq-answer {
    min-height: 300px;
    padding: 15px;
  }

  .faq-item.active .faq-icon {
    transform: rotate(180deg);
  }
  .faq-title {
    text-align: center;
    font-family: gilroy-bold;
    margin-top: 20px;
    margin-bottom: 20px;
    color: var(--color-title);
  }
</style>

<!--faq/buy-page -->
<script is:inline>
  class FAQManager {
    constructor() {
      this.isInitialized = false;
      this.openItems = [];
    }

    toggleFAQ(event) {
      const question = event.currentTarget;
      const answer = question.nextElementSibling;
      const icon = question.querySelector(".faq-icon");
      const isOpen = answer.style.maxHeight;

      if (isOpen) {
        answer.style.maxHeight = null;
        icon.style.transform = "rotate(0deg)";
        this.openItems = this.openItems.filter((item) => item !== answer);
      } else {
        if (this.openItems.length >= 2) {
          const oldestOpenItem = this.openItems.shift();
          const oldestIcon =
            oldestOpenItem.previousElementSibling.querySelector(".faq-icon");
          oldestOpenItem.style.maxHeight = null;
          oldestIcon.style.transform = "rotate(0deg)";
        }
        answer.style.maxHeight = answer.scrollHeight + "px";
        icon.style.transform = "rotate(180deg)";
        this.openItems.push(answer);
      }
    }

    setupFAQInteraction() {
      const questions = document.querySelectorAll(".faq-item .faq-question");
      if (questions.length === 0) return;

      questions.forEach((question) => {
        // Удаляем старые обработчики
        const clone = question.cloneNode(true);
        question.parentNode.replaceChild(clone, question);
        // Добавляем новый обработчик
        clone.addEventListener("click", (e) => this.toggleFAQ(e));
      });
    }

    init() {
      // Добавляем небольшую задержку для гарантии загрузки DOM
      setTimeout(() => {
        const title = document.querySelector(".faq-title");
        if (title) {
          title.style.pointerEvents = "none";
        }
        this.setupFAQInteraction();
        this.isInitialized = true;
      }, 0);
    }

    reset() {
      this.isInitialized = false;
      this.openItems = [];
    }
  }

  // Создаем единственный экземпляр менеджера FAQ в глобальной области видимости
  window.faqManager = window.faqManager || new FAQManager();

  // Функция инициализации
  function initFAQ() {
    if (window.faqManager) {
      window.faqManager.reset();
      window.faqManager.init();
    }
  }

  // Обработчики для разных сценариев загрузки
  document.addEventListener("DOMContentLoaded", initFAQ);
  window.addEventListener("load", initFAQ);
  document.addEventListener("astro:page-load", initFAQ);
</script>
